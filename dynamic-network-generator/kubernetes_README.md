# Kubernetes version of the lab (in process)

To map the docker-compose.yaml to a valid kubernetes yaml file we can use kompose (`https://kubernetes.io/docs/tasks/configure-pod-container/translate-compose-kubernetes/`). Once you have installed run `kompose convert` on the same folder where the docker-compose.yaml is located, this will generate all the necessary yaml files for kubernetes.

## To consider

* The kubernetes sintax is a little different than the docker-compose.yaml file, in this case we need to make sure that the hostname of the nodes are all lowercase, that the docker-compose version is `3` and that there is no underscores on the file `_`.

* To expose the ports on kubernetes and be able to access manager, we need to set the type on the service.yaml to NodePort, here is a sample of the section for a service called `D`:

```
spec:
  type: NodePort
  ports:
    - name: "8522"
      port: 8522
      targetPort: 8522
  selector:
    io.kompose.service: d
```
## Usage

* Run `kompose convert` on the folder with the docker-compose.yaml.

* Add the `type: NodePort` to the service which will be used to expose the port.

* To start the deployment use `kubectl apply -f file1.yaml,file2.yaml,...,filen.yaml` with all the files generated by the `kompose convert`

* To clean the environment use `kubectl remove -f file1.yaml,file2.yaml,...,filen.yaml` with all the files generated by the `kompose convert`

