# Docker images

Script for building docker images to run cloud-manager or odevapp on containers. 

For cloud-manager, the application needs a Java keystore that is generated by the `new_star_local_key.sh` script. It is important to have `docker-entrypoint.sh` and the generated keystore on the root folder so the docker build can copy them into the images.

For odevapp,it is important to have `doe_odevapp.sh` on the root folder so the docker build can copy them into the images.

## Usage

Important note: In order to push the images to AWS ECR, you must authenticate docker on the AMAZON ECR private registry. For additional information check: https://docs.aws.amazon.com/AmazonECR/latest/userguide/registry_auth.html

### Cloud-Manager
First run new_star_local_key.sh and follow the steps provided to generate the Java keystore.

The `build.sh` script builds the docker images for Ubuntu and Centos. It also allows you to specify the cloud or manager version to download from AWS. To check the usage of this script, run `build.sh -h`.

### Odevapp
The `build.py` script builds the docker images for Ubuntu and Centos. It also allows you to specify the osmosis version to download from AWS. To check the usage of this script, run `build.py -h`.

## Folders

The `dockerfiles` directory have the dockerfiles for the different distributions (currently Ubuntu and Centos).

The `lib` has the scripts used for creating the tar files used by the docker images.

## Files
### docker-entrypoint.sh and doe_odevapp.sh

Used on the docker containers for running osmosis and updating the configuration files according to the flags provided.

### star_local file

This is the Java keystore for running osmosis. To generate it, run the `new_star_local_key.sh` script. The resulting file is located in the osmosis folder of the Docker repository.

### osmosis_files.sh

Creates the osmosis tar file to use on the docker images.